<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Live Silver Tracker</title>
    <style>
        body { font-family: -apple-system, sans-serif; background: #121212; color: #ffffff; padding: 20px; margin: 0; }
        .card { max-width: 450px; margin: auto; background: #1e1e1e; padding: 25px; border-radius: 20px; border: 1px solid #333; box-shadow: 0 10px 30px rgba(0,0,0,0.5); }
        h2 { text-align: center; color: #00ff88; margin-top: 0; letter-spacing: 1px; }
        
        .price-banner { background: #252525; padding: 15px; border-radius: 12px; text-align: center; border-left: 5px solid #00ff88; margin-bottom: 20px; }
        #liveSpot { font-size: 24px; font-weight: bold; color: #00ff88; }
        .status { font-size: 10px; color: #888; text-transform: uppercase; margin-top: 5px; }

        label { display: block; margin: 15px 0 8px; font-size: 12px; color: #aaa; text-transform: uppercase; font-weight: bold; }
        input, select { width: 100%; padding: 16px; background: #2c2c2c; border: 1px solid #444; color: white; border-radius: 12px; font-size: 18px; box-sizing: border-box; }
        
        .radio-grid { display: flex; gap: 10px; margin-bottom: 10px; }
        .r-btn { flex: 1; position: relative; }
        .r-btn input { position: absolute; opacity: 0; }
        .r-btn label { display: block; background: #2c2c2c; padding: 12px; text-align: center; border-radius: 8px; border: 1px solid #444; cursor: pointer; font-size: 14px; }
        .r-btn input:checked + label { background: #00ff88; color: #000; border-color: #fff; font-weight: bold; }

        button { width: 100%; padding: 20px; background: #00ff88; color: #000; border: none; border-radius: 15px; font-size: 20px; font-weight: bold; margin-top: 25px; cursor: pointer; }
        #result { margin-top: 25px; padding: 20px; background: #00ff8815; border-radius: 15px; border: 1px dashed #00ff88; text-align: center; display: none; }
        .val-out { font-size: 38px; font-weight: bold; color: #00ff88; display: block; }
    </style>
</head>
<body>

<div class="card">
    <h2>SILVER MELT PRO</h2>

    <div class="price-banner">
        <div id="liveSpot">Loading Price...</div>
        <div class="status" id="priceStatus">Syncing with Market</div>
    </div>

    <div class="radio-grid">
        <div class="r-btn">
            <input type="radio" name="mode" id="useLive" checked onclick="toggleInput(false)">
            <label for="useLive">Use Live Price</label>
        </div>
        <div class="r-btn">
            <input type="radio" name="mode" id="useMan" onclick="toggleInput(true)">
            <label for="useMan">Manual Entry</label>
        </div>
    </div>

    <div id="manualInput" style="display:none;">
        <label>Set Custom Price ($/oz)</label>
        <input type="number" id="customSpot" placeholder="75.00" step="0.01">
    </div>

    <label>Total Face Value ($)</label>
    <input type="number" id="face" inputmode="decimal" placeholder="e.g. 10.00">

    <label>Coin Purity</label>
    <select id="purity">
        <option value="0.715">90% Dimes/Quarters/Halves</option>
        <option value="0.7734">90% Silver Dollars</option>
        <option value="0.295">40% Kennedy Halves</option>
    </select>

    <button onclick="calculate()">CALCULATE VALUE</button>

    <div id="result">
        <span style="color:#888; font-size: 14px;">TOTAL MELT VALUE</span>
        <span class="val-out" id="output">$0.00</span>
    </div>
</div>

<script>
    let currentLivePrice = 0;

    // 1. Function to Fetch Live Price
    async function fetchPrice() {
        try {
            // Using a public financial data proxy
            const response = await fetch('https://api.gold-api.com/price/XAG');
            const data = await response.json();
            
            // Note: Some APIs return price in Grams or Ounces. 
            // This API returns price per Ounce.
            currentLivePrice = data.price;
            
            document.getElementById('liveSpot').innerText = '$' + currentLivePrice.toFixed(2);
            document.getElementById('priceStatus').innerText = 'Live Market Price (USD)';
        } catch (error) {
            document.getElementById('liveSpot').innerText = 'Connection Error';
            document.getElementById('priceStatus').innerText = 'Please use Manual Entry';
            console.error("Price fetch failed:", error);
        }
    }

    // 2. Toggle manual vs live input
    function toggleInput(isManual) {
        document.getElementById('manualInput').style.display = isManual ? 'block' : 'none';
    }

    // 3. Main Calculation Logic
    function calculate() {
        let spot = currentLivePrice;
        if(document.getElementById('useMan').checked) {
            spot = parseFloat(document.getElementById('customSpot').value);
        }

        const face = parseFloat(document.getElementById('face').value);
        const mult = parseFloat(document.getElementById('purity').value);

        if(!face || isNaN(face) || !spot || isNaN(spot)) {
            alert("Please ensure all fields are filled.");
            return;
        }

        const total = face * mult * spot;
        document.getElementById('result').style.display = 'block';
        document.getElementById('output').innerText = '$' + total.toLocaleString(undefined, {minimumFractionDigits: 2, maximumFractionDigits: 2});
    }

    // Auto-fetch price on page load
    fetchPrice();
</script>

</body>
</html>